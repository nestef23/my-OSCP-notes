## Intro
Recon of the SMB services on both Linux and Windows


## Nmap
Use nmap scripts for additional enumeration
```
nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse <IP>
```
Interesting findings include
- anonymous share
- share with weird name

### Smbclient
List shares
```
smbclient -L //<IP>
```

Connect to the anonymous share
```
smbclient //<IP>/anonymous
# In case of "/" error do it like this
smbclient ////<IP>//anonymous
# With credentials
smbclient //<IP>/<share> -U <domain>\\<user>%<password>
```

### smbmap
map shares
```
smbmap -H <IP>
smbmap -H <IP> -d <domain> -u <user> -p <password>
```
Recursively list all files on a share
```
smbmap -H <IP> -R
```
## Tricks
If policies folder is visible search for **Groups.xml** file as it can contain GPP Passwords
GPP password can be decprypted with 
```
gpp-decrypt
```
